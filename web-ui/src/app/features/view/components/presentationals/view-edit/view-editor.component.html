
<ng-container *ngIf="currView$ | async as currView">
    <!-- Saved View Selection -->
    <div class="d-flex flex-column">
        <div class="p-2 me-auto">
            <mat-form-field subscriptSizing="dynamic"> 
                <mat-label>Ref. View</mat-label>
                <mat-select [(value)]="currView.id" (valueChange)="SelectView($event)">
                    @for (viewId of this.Ref.ViewIds; track $index) {
                        <mat-option [value]="viewId">{{this.Ref.views.get(viewId)!.name}}</mat-option>
                    }
                </mat-select>
            </mat-form-field>
        </div>
        @if (!isInjectionMode) {
            <!-- View Saving Field -->
            <div class="p-2">
                <div class="d-flex">
                    <!-- I hate padding -->
                    <div class="p-2" style="padding-left: 0 !important;">
                        <mat-form-field style="width:20em" subscriptSizing="dynamic">
                            <mat-label>Save Current View</mat-label>
                            <input matInput placeholder="Awesome View" [formControl]="newViewId">
                        </mat-form-field>
                    </div>
                    <div class="p-2">
                        <button mat-raised-button color="primary" style="height:4em; width: 6em;" (click)="save(currView)">Save</button>
                    </div>
                </div>
            </div>
            <!-- Consultation of a Referential View, columns and lines -->
            <div class="d-flex">
                <div class="p-2">
                    <mat-form-field subscriptSizing="dynamic">
                        <mat-label>Add Search Field</mat-label>
                        <mat-select [(value)]="currView.searchAddOpt">
                            @for (colId of currView.nSearchCols; track $index) {
                            <mat-option [value]="colId">{{Ref.getColumnById(colId)}}</mat-option>
                            }
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="p-2">
                    <button mat-raised-button color="primary" style="height:4em; width: 6em;" (click)="currView.addSearchCol(currView.searchAddOpt)">Add</button>
                </div>
                <div class="p-2">
                    <mat-form-field subscriptSizing="dynamic">
                        <mat-label>Add Table Column</mat-label>
                        <mat-select [(value)]="currView.dispAddOpt">
                            @for (colId of currView.nDispCols; track $index) {
                            <mat-option [value]="colId">{{Ref.getColumnById(colId)}}</mat-option>
                            }
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="p-2">                             <!-- Backend dev that does front-end solution. This will break on mobile. -->
                    <button mat-raised-button color="primary" style="height:4em; width: 6em; margin-right: auto;" (click)="currView.addDispCol(currView.dispAddOpt)">Add</button>
                </div>
            </div>
        }
    </div>
</ng-container>